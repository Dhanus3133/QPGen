import { useEffect } from "react";
import Vditor from "vditor";

export default function InitializeVditor({ id, value, vd, setVd }) {
  useEffect(() => {
    if (!vd) {
      const vditor = new Vditor(id, {
        after: () => {
          setVd(vditor);
        },
        toolbar: [
          "headings",
          "bold",
          "italic",
          "strike",
          "|",
          "list",
          "ordered-list",
          "check",
          "outdent",
          "indent",
          "|",
          "quote",
          "line",
          "code",
          "inline-code",
          "insert-before",
          "insert-after",
          "|",
          "upload",
          "table",
          "|",
          "undo",
          "redo",
          "|",
          "fullscreen",
          "edit-mode",
          "|",
          {
            icon: '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="_x32_" width="800px" height="800px" viewBox="0 0 512 512" xml:space="preserve"><g><path class="st0" d="M406.195,383.984c-8.391,15.734-19.922,28.859-34.516,39.609c-14.656,10.719-32.188,18.703-52.563,23.969   c-8.906,2.25-18.234,3.813-27.703,5.094V512h-70.828v-58.156c-20.172-1.703-39.453-4.844-57.609-9.844   c-27.719-7.594-64.016-38.25-64.016-38.25c-3.109-1.813-5.172-5-5.609-8.531c-0.453-3.563,0.766-7.156,3.313-9.688l35.484-35.5   c3.828-3.781,9.766-4.5,14.359-1.688c0,0,26.563,23.063,46.688,28.563c20.125,5.469,40.094,8.219,60.016,8.219   c25.125,0,45.891-4.438,62.359-13.313c16.5-8.938,24.719-22.75,24.719-41.625c0-13.594-4.031-24.313-12.172-32.188   c-8.109-7.813-21.828-12.734-41.188-14.891l-63.563-5.469c-37.641-3.672-66.672-14.172-87.063-31.375   c-20.453-17.266-30.609-43.453-30.609-78.453c0-19.375,3.906-36.625,11.766-51.797c7.875-15.172,18.563-27.984,32.172-38.422   c13.594-10.469,29.438-18.313,47.469-23.531c7.547-2.188,15.453-3.625,23.484-4.938V0h70.828v50.094   c16.531,1.625,32.266,4.281,46.906,8.313c24.844,6.781,50.938,27.188,50.938,27.188c3.266,1.688,5.484,4.875,6.047,8.5   c0.563,3.688-0.641,7.313-3.219,9.969l-33.281,33.781c-3.547,3.594-9.031,4.531-13.563,2.188c0,0-19.703-14.031-36.734-18.469   c-17.016-4.438-34.891-6.688-53.719-6.688c-24.609,0-42.797,4.719-54.531,14.109c-11.781,9.453-17.625,21.734-17.625,36.875   c0,13.641,4.109,24.078,12.531,31.359c8.359,7.344,22.469,12.109,42.359,14.125l55.703,4.75   c41.297,3.656,72.563,14.625,93.734,32.922c21.203,18.328,31.781,45.016,31.781,80.016   C418.742,350.016,414.554,368.281,406.195,383.984z"/></g></svg>',
            hotkey: "",
            name: "bold",
            tip: "Latex Inline",
            prefix: "$",
            suffix: "$",
            tipPosition: "ne",
          },
          {
            icon: '<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" id="_x32_" width="800px" height="800px" viewBox="0 0 512 512" xml:space="preserve"><g><path class="st0" d="M406.195,383.984c-8.391,15.734-19.922,28.859-34.516,39.609c-14.656,10.719-32.188,18.703-52.563,23.969   c-8.906,2.25-18.234,3.813-27.703,5.094V512h-70.828v-58.156c-20.172-1.703-39.453-4.844-57.609-9.844   c-27.719-7.594-64.016-38.25-64.016-38.25c-3.109-1.813-5.172-5-5.609-8.531c-0.453-3.563,0.766-7.156,3.313-9.688l35.484-35.5   c3.828-3.781,9.766-4.5,14.359-1.688c0,0,26.563,23.063,46.688,28.563c20.125,5.469,40.094,8.219,60.016,8.219   c25.125,0,45.891-4.438,62.359-13.313c16.5-8.938,24.719-22.75,24.719-41.625c0-13.594-4.031-24.313-12.172-32.188   c-8.109-7.813-21.828-12.734-41.188-14.891l-63.563-5.469c-37.641-3.672-66.672-14.172-87.063-31.375   c-20.453-17.266-30.609-43.453-30.609-78.453c0-19.375,3.906-36.625,11.766-51.797c7.875-15.172,18.563-27.984,32.172-38.422   c13.594-10.469,29.438-18.313,47.469-23.531c7.547-2.188,15.453-3.625,23.484-4.938V0h70.828v50.094   c16.531,1.625,32.266,4.281,46.906,8.313c24.844,6.781,50.938,27.188,50.938,27.188c3.266,1.688,5.484,4.875,6.047,8.5   c0.563,3.688-0.641,7.313-3.219,9.969l-33.281,33.781c-3.547,3.594-9.031,4.531-13.563,2.188c0,0-19.703-14.031-36.734-18.469   c-17.016-4.438-34.891-6.688-53.719-6.688c-24.609,0-42.797,4.719-54.531,14.109c-11.781,9.453-17.625,21.734-17.625,36.875   c0,13.641,4.109,24.078,12.531,31.359c8.359,7.344,22.469,12.109,42.359,14.125l55.703,4.75   c41.297,3.656,72.563,14.625,93.734,32.922c21.203,18.328,31.781,45.016,31.781,80.016   C418.742,350.016,414.554,368.281,406.195,383.984z"/></g></svg>',
            hotkey: "",
            name: "bold",
            tip: "Latex block",
            prefix: "$$",
            suffix: "$$",
            tipPosition: "ne",
          },
          {
            icon: '<svg enable-background="new 0 0 64 64" height="64px" id="Layer_1" version="1.1" viewBox="0 0 64 64" width="64px" xml:space="preserve" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"><path d="M45.73,64H34.752c-0.715,0-1.295-0.173-1.738-0.52s-0.794-0.758-1.056-1.234l-9.484-16.564  c-0.174,0.478-0.369,0.887-0.584,1.234l-8.835,15.33c-0.304,0.434-0.661,0.834-1.072,1.201C11.572,63.816,11.041,64,10.391,64H0.127  L15.36,39.641L0.712,16.675H11.69c0.714,0,1.24,0.093,1.576,0.276c0.335,0.185,0.634,0.493,0.893,0.926l9.42,15.948  c0.108-0.28,0.232-0.552,0.374-0.812c0.14-0.262,0.297-0.531,0.471-0.813l8.25-14.161c0.305-0.477,0.622-0.823,0.958-1.04  c0.336-0.217,0.752-0.325,1.251-0.325h10.524L30.562,39.186L45.73,64z"/><path d="M61.84,23.86c0.667,0,1.193,0.183,1.58,0.55c0.387,0.366,0.58,0.85,0.58,1.45v3.6H43.521v-2c0-0.387,0.079-0.8,0.239-1.24  c0.16-0.439,0.44-0.84,0.84-1.2l8.4-8.46c0.721-0.72,1.347-1.406,1.881-2.06c0.533-0.653,0.973-1.297,1.319-1.93  c0.347-0.634,0.606-1.267,0.78-1.9c0.173-0.633,0.26-1.304,0.26-2.01c0-1.16-0.277-2.05-0.83-2.67  c-0.553-0.62-1.396-0.93-2.529-0.93c-0.92,0-1.697,0.243-2.33,0.73c-0.634,0.487-1.07,1.09-1.311,1.81  c-0.279,0.733-0.646,1.22-1.1,1.46c-0.453,0.24-1.1,0.293-1.94,0.16l-3.28-0.58c0.213-1.453,0.623-2.72,1.23-3.8  c0.606-1.08,1.359-1.98,2.26-2.7c0.9-0.72,1.93-1.257,3.09-1.61C51.66,0.177,52.906,0,54.24,0c1.439,0,2.736,0.21,3.891,0.63  c1.152,0.42,2.137,1.003,2.949,1.75c0.813,0.747,1.438,1.637,1.87,2.67C63.383,6.083,63.6,7.22,63.6,8.46  c0,1.066-0.149,2.054-0.449,2.96c-0.301,0.907-0.71,1.771-1.23,2.59c-0.52,0.82-1.123,1.613-1.81,2.38  c-0.687,0.768-1.417,1.544-2.19,2.33l-5.699,5.84c0.732-0.227,1.459-0.399,2.18-0.52c0.72-0.12,1.387-0.18,2-0.18H61.84z"/></svg>',
            hotkey: "",
            name: "bold",
            tip: "Power",
            prefix: "$^{",
            suffix: "}$",
            tipPosition: "ne",
          },
          {
            icon: '<svg viewBox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><path d="M496 448h-16V304a16 16 0 0 0-16-16h-48a16 16 0 0 0-14.29 8.83l-16 32A16 16 0 0 0 400 352h16v96h-16a16 16 0 0 0-16 16v32a16 16 0 0 0 16 16h96a16 16 0 0 0 16-16v-32a16 16 0 0 0-16-16zM336 64h-67a16 16 0 0 0-13.14 6.87l-79.9 115-79.9-115A16 16 0 0 0 83 64H16A16 16 0 0 0 0 80v48a16 16 0 0 0 16 16h33.48l77.81 112-77.81 112H16a16 16 0 0 0-16 16v48a16 16 0 0 0 16 16h67a16 16 0 0 0 13.14-6.87l79.9-115 79.9 115A16 16 0 0 0 269 448h67a16 16 0 0 0 16-16v-48a16 16 0 0 0-16-16h-33.48l-77.81-112 77.81-112H336a16 16 0 0 0 16-16V80a16 16 0 0 0-16-16z"/></svg>',
            hotkey: "",
            name: "bold",
            tip: "Subscript",
            prefix: "$_{",
            suffix: "}$",
            tipPosition: "ne",
          },
        ],
        lang: "en_US",
        width: "100%",
        upload: {
          url: "/upload/",
          multiple: false,
        },
      });
    }
  }, []);
  useEffect(() => {
    if (vd) {
      vd.setValue(value);
    }
  }, [vd]);
}
